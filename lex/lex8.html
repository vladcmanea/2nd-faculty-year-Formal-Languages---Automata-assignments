<html><head><title>LEX</title></head><body style='font-family:"courier new"'><span style='color: #f60'>#ifndef&nbsp;_DES</span><br /><span style='color: #f60'>#define&nbsp;_DES</span><br /><br /><span style='color: #f60'>#include&nbsp;&lt;ctime&gt;</span><br /><span style='color: #f60'>#include&nbsp;&lt;NTL/ZZ.h&gt;</span><br /><span style='color: #f60'>#include&nbsp;&lt;fstream&gt;</span><br /><span style='color: #f60'>#include&nbsp;&lt;iostream&gt;</span><br /><span style='color: #666'>using</span>&nbsp;<span style='color: #666'>namespace</span>&nbsp;<span style='color: #666'>std</span><span style='color: #999'>;</span><br /><br /><span style='color: #666'>NTL_CLIENT</span><br /><br /><span style='color: #060'>//&nbsp;RSA&nbsp;class</span><br /><span style='color: #009'>class</span>&nbsp;<span style='color: #009'>RSA</span><br /><span style='color: #990'>{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #060'>//&nbsp;computes&nbsp;x&nbsp;^&nbsp;p&nbsp;mod&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #666'>ZZ</span>&nbsp;<span style='color: #009'>RSA</span><span style='color: #909'>::</span><span style='color: #900'>ModPower</span><span style='color: #660'>(</span><span style='color: #009'>const</span>&nbsp;<span style='color: #009'>long</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>x</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>const</span>&nbsp;<span style='color: #009'>long</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>p</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>const</span>&nbsp;<span style='color: #009'>long</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>n</span><span style='color: #660'>)</span><span style='color: #999'>;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #060'>//&nbsp;finds&nbsp;if&nbsp;l,&nbsp;d&nbsp;can&nbsp;be&nbsp;the&nbsp;l&nbsp;and&nbsp;d&nbsp;in&nbsp;e&nbsp;*&nbsp;d&nbsp;-&nbsp;1&nbsp;=&nbsp;l&nbsp;*&nbsp;phi(n)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #009'>bool</span>&nbsp;<span style='color: #900'>criteria</span><span style='color: #660'>(</span><span style='color: #009'>long</span>&nbsp;<span style='color: #666'>l</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>long</span>&nbsp;<span style='color: #666'>d</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>long</span>&nbsp;<span style='color: #666'>n</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>long</span>&nbsp;<span style='color: #666'>e</span><span style='color: #660'>)</span><span style='color: #999'>;</span><br /><br /><span style='color: #009'>public</span><span style='color: #909'>:</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #060'>//&nbsp;encrypts&nbsp;to&nbsp;fa</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #009'>void</span>&nbsp;<span style='color: #900'>applyEncrypt</span><span style='color: #660'>(</span><span style='color: #009'>istream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fc</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>istream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fp</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>ostream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fa</span><span style='color: #660'>)</span><span style='color: #999'>;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #060'>//&nbsp;decrypts&nbsp;to&nbsp;fa</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #009'>void</span>&nbsp;<span style='color: #900'>applyDecrypt</span><span style='color: #660'>(</span><span style='color: #009'>istream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fc</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>istream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fp</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>istream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fs</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>ostream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fa</span><span style='color: #660'>)</span><span style='color: #999'>;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #060'>//&nbsp;applies&nbsp;Wiener&nbsp;decryption</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #009'>void</span>&nbsp;<span style='color: #900'>applyWienerDecrypt</span><span style='color: #660'>(</span><span style='color: #009'>istream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fc</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>istream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fp</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>ostream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fa</span><span style='color: #660'>)</span><span style='color: #999'>;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #060'>//&nbsp;divides&nbsp;into&nbsp;factors</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #009'>void</span>&nbsp;<span style='color: #900'>applyFactors</span><span style='color: #660'>(</span><span style='color: #009'>istream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fp</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>istream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fs</span><span style='color: #999'>,</span>&nbsp;<span style='color: #009'>ostream</span>&nbsp;<span style='color: #909'>&</span><span style='color: #666'>fa</span><span style='color: #660'>)</span><span style='color: #999'>;</span><br /><span style='color: #990'>}</span><span style='color: #999'>;</span><br /><br /><span style='color: #f60'>#endif</span><br /><hr /><b>Declaratii de functii</b><hr />bool&nbsp;criteria(long&nbsp;l,&nbsp;long&nbsp;d,&nbsp;long&nbsp;n,&nbsp;long&nbsp;e);<br />void&nbsp;applyEncrypt(istream&nbsp;&fc,&nbsp;istream&nbsp;&fp,&nbsp;ostream&nbsp;&fa);<br />void&nbsp;applyDecrypt(istream&nbsp;&fc,&nbsp;istream&nbsp;&fp,&nbsp;istream&nbsp;&fs,&nbsp;ostream&nbsp;&fa);<br />void&nbsp;applyWienerDecrypt(istream&nbsp;&fc,&nbsp;istream&nbsp;&fp,&nbsp;ostream&nbsp;&fa);<br />void&nbsp;applyFactors(istream&nbsp;&fp,&nbsp;istream&nbsp;&fs,&nbsp;ostream&nbsp;&fa);<br /><hr /><b>Tipuri predefinite utilizate</b><hr />long<br />bool<br />void<br />istream<br />ostream<br /><hr /><b>Tipuri noi</b><hr />RSA<br /></body></html>